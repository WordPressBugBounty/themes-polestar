jQuery(function(e){var i=function(i){var t=e(i),r=e("<div></div>").html('<span class="current">'+t.find(":selected").html()+"</span>"+polestar_data.chevron_down).addClass("ordering-selector-wrapper").insertAfter(t),n=e("<div/>").addClass("ordering-dropdown-container").appendTo(r),i=e("<ul></ul>").addClass("ordering-dropdown").appendTo(n),o=0;t.find("option").each(function(){var t=e(this);i.append(e("<li></li>").html(t.html()).data("val",t.attr("value"))),r.find(".current").html(t.html()),o=Math.max(r.find(".current").width(),o)}),r.find(".current").html(t.find(":selected").html()),r.find(".current").width(o),t.hide()};e(document).on("click",".ordering-selector-wrapper .ordering-dropdown li",function(){var i=e(this).parents(".polestar-variations-wrapper, .woocommerce-ordering").find("select");i.val(e(this).data("val")).trigger("change"),i.hasClass("woocommerce-ordering")?i.closest("form").trigger("submit"):($variations=e(this).parents(".variations"),$variations.length?$variations.find(".polestar-variations-wrapper").each(function(){var i=e(this).find(".ordering-dropdown");i.empty(),e(this).find("option").each(function(t){var r=e(this);i.append(e("<li></li>").html(r.html()).data("val",r.attr("value")))}),e(this).find(".current").text(e(this).find("select").find(":selected").text())}):e(this).parents(".ordering-selector-wrapper").find(".current").text(e(this).text()))}),e(".woocommerce-ordering select, .polestar-variations-wrapper select").each(function(){i(this)}),e(document).on("click",".ordering-selector-wrapper",function(){e(".open-dropdown").removeClass("open-dropdown"),e(this).toggleClass("open-dropdown")}),e(window).on("click",function(i){e(i.target).closest(".ordering-selector-wrapper.open-dropdown").length||e(".ordering-selector-wrapper.open-dropdown").removeClass("open-dropdown")}),e(document).on("click",".woocommerce .product .variations .reset_variations",function(){e(this).parents(".variations_form").find(".polestar-variations-wrapper").each(function(){var i=e(this);i.find(".current").text(i.find(".ordering-dropdown li").first().text()),i.find("select").find(":selected").prop("selected",!1),i.find("select").trigger("change")})}),e(".product-quick-view-button").on("click",function(t){t.preventDefault();var r="#quick-view-container",n="#product-quick-view",o=e(this).attr("data-product-id");e.post(polestar_data.ajaxurl,{action:"polestar_product_quick_view",product_id:o},function(t){e(document).find(r).find(n).html(t),e(document).find("#product-quick-view .variations_form").wc_variation_form(),e(document).find("#product-quick-view .variations_form").trigger("check_variations"),e("#quick-view-container .polestar-variations-wrapper select").each(function(){i(this)})}),e(document).ajaxComplete(function(){e.isFunction(e.fn.flexslider)&&(e(".product-images-slider").flexslider({animation:"slide",customDirectionNav:e(this).find(".flex-direction-nav a"),start:function(){e(".flexslider .slides img").show()}}),e("#product-quick-view .variations_form").on("found_variation.wc-variation-form",function(i,t){if(t&&t.image&&t.image.full_src){var r=e("#product-quick-view .product-gallery-image").find('img[src="'+t.image.full_src+'"]');r.length>0?e(".product-images-slider").flexslider(r.parent().index(".product-images-slider  .slide")-1):e(".product-images-slider").flexslider(0)}}),e("#product-quick-view .variations_form").on("reset_image",function(i,t){e(".product-images-slider").flexslider(0)}))}),e(document).find(r).is(":hidden")&&e(document).find(r).find(n).empty(),e(document).find(r).fadeIn(300),e("body").css("margin-right",window.innerWidth-e("body").width()+"px"),e("body").css("overflow","hidden"),e(window).on("mouseup",function(i){var t=e(n);(!t.is(i.target)&&0===t.has(i.target).length||e(".quickview-close-icon").is(i.target))&&(e(r).fadeOut(300),e("body").css("overflow",""),e("body").css("margin-right",""))}),e(document).on("keyup",function(i){e(n);27==i.keyCode&&(e(r).fadeOut(300),e("body").css("overflow",""),e("body").css("margin-right",""))})})});